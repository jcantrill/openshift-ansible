apiVersion: v1
kind: Pod
metadata:
  labels:
    logging-infra: support
  generateName: jks-cert-gen-
spec:
  containers:
  - name: jks-cert-gen
    image: {{image_prefix}}logging-deployer:{{image_version}}
    imagePullPolicy: Always
    command: ["sh",  "generate-jks.sh"]
    securityContext:
      privileged: true
    volumeMounts:
    - mountPath: /opt/deploy
      name: certmount
    env:
    - name: PROJECT
      value: {{logging_namespace}}
  restartPolicy: Never
  serviceAccount: aggregated-logging-fluentd
  volumes:
  - hostPath:
      path: "{{etcd_generated_certs_dir}}/logging"
    name: certmount
